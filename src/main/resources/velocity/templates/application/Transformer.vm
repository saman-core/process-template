package ${template.getPackageNameFormatted()}.${template.getProductNameFormattedLowerCase()}.${template.getNameFormattedLowerCase()}.transformer;

import org.jboss.logging.Logger;
import io.samancore.common.transformer.GenericTransformer;
import io.samancore.common.error.message.TechnicalExceptionsEnum;
import ${template.getPackageNameFormatted()}.${template.getProductNameFormattedLowerCase()}.${template.getNameFormattedLowerCase()}.entity.${template.getNameFormatted()}Entity;
import ${template.getPackageNameFormatted()}.${template.getProductNameFormattedLowerCase()}.${template.getNameFormattedLowerCase()}.model.${template.getNameFormatted()}Model;
import io.samancore.common.error.util.ExceptionHandler;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.inject.Inject;

@ApplicationScoped
public class  ${template.getNameFormatted()}Transformer extends GenericTransformer<${template.getNameFormatted()}Entity, ${template.getNameFormatted()}Model> {

    @Inject
    Logger log;


    #set ($injects = ${template.getInjectToTransform()})
    #foreach($inject in $injects)
        @Inject
        $inject
    #end

    public ${template.getNameFormatted()}Entity toEntity(${template.getNameFormatted()}Model model) {
        try {
            log.debugf("${template.getNameFormatted()}Transformer.toEntity model: %s", model);
            #if(${template.evaluateIfAnyFieldNeedPairToEntity()})
            #foreach ($field in $template.getAllFieldWithPair())
            ${field.getPairTransformToEntity()}
            #end
            ${template.getTransformToEntity()}
            #else
            return transformToEntity(model);
            #end
        } catch (Exception e) {
            log.error(e.getMessage(), e);
            throw ExceptionHandler.throwNotFoundOrLocal(TechnicalExceptionsEnum.TRANSFORMER_OBJECT_ERROR, e);
        }
    }

    public ${template.getNameFormatted()}Model toModel(${template.getNameFormatted()}Entity entity) {
        try {
            log.debugf("${template.getNameFormatted()}Transformer.toModel entity: %s", entity);
            #if(${template.evaluateIfAnyFieldNeedPairToModel()})
            #foreach ($field in $template.getAllFieldWithPair())
            ${field.getPairTransformToModel()}
            #end
            ${template.getTransformToModel()}
            #else
            return transformToModel(entity);
            #end
        } catch (Exception e) {
        log.error(e.getMessage(), e);
        throw ExceptionHandler.throwNotFoundOrLocal(TechnicalExceptionsEnum.TRANSFORMER_OBJECT_ERROR, e);
        }
    }

    public ${template.getNameFormatted()}Entity copyToAttached(${template.getNameFormatted()}Entity detached, ${template.getNameFormatted()}Entity attached) {
        try {
            log.debugf("${template.getNameFormatted()}Transformer.copyToAttached");
            return transformCopyToAttached(detached, attached);
        } catch (Exception e) {
            log.error(e.getMessage(), e);
            throw ExceptionHandler.throwNotFoundOrLocal(TechnicalExceptionsEnum.TRANSFORMER_OBJECT_ERROR, e);
        }
    }

    #foreach ($field in $template.getAllFieldWithPair())
    #set ($transformMethod = ${field.getMethodTransformToEntity()})
    #foreach($transformMethodLine in $transformMethod)
        $transformMethodLine
    #end
    #set ($transformMethod_ = ${field.getMethodTransformToModel()})
    #foreach($transformMethodLine_ in $transformMethod_)
        $transformMethodLine_
    #end
    #end
}